---
title: "Potatoes Cold Climate Adaptation"
author: "Sina Mokhtar"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```


```{r echo = F}
#library(lmtest)
library(car)
potato<-read.table("RawData/potato.txt",header=TRUE)
potato$regime<-factor(potato$regime,label=c("R","C"))
potato$variety<-factor(potato$variety,label=c("s1","s2"))
potato$temp<-factor(potato$temp,label=c("-4","-8"))
attach(potato)
```



## Summary:

problem: This project analyzes data from an experiment on how plants adapt to cold climates, specifically focusing on the effect of different experimental factors on ion leakage as a response variable

what we found:  

briefly interpret the result:  


## key graphs

profile plots, hasse diagram, cube plots etc. And of course, every plot you include
must contain a complete caption



## Introduction:

The study explores how plants adapt to cold climates by examining the effects of three experimental factors (species, regime, and temperature) on ion leakage. The investigation was prompted by the observation that plants conditioned to cold climates experience less damage when exposed to cold temperatures. Two potato species (s1; s2) were studied, and each plant was assigned to one of two acclimatization regimes levels (C = plant was kept in a cold room; R = plant was kept at room temperature) and later subjected to one of two cold temperatures levels (-4 degrees; -8 degrees). The damage scores for photosynthesis and ion leakage were measured, but ion leakage was selected as the response variable for this project. Some of the 80 plants assigned initially to the treatment combinations were lost during the experiment. The study aims to evaluate the impact of the three experimental factors on ion leakage. In subsequent sections, we will discuss the methodology used for data analysis, including the statistical models and hypothesis testing. We will then present the analysis results, including the experimental factors' effects on ion leakage. Finally, we will conclude with a discussion of the implications of the findings and suggestions for future research. 



## Exploration
For investigating the effect of a factor on a variable we can use Analysis of variance (ANOVA) which is a collection of statistical models and their associated estimation procedures used to analyze the differences among means. For following this procedure, we started exploration by making boxplots for the levels of each factor (Fig.1) 

```{r  echo=FALSE, fig.cap="Boxplots of the mean damage score for leaksynthesis by variety, regime, and temperature in potato plants.", fig.align="center"}
#boxplot
par(mfrow=c(1,3))
boxplot(leak ~ variety,
data = potato,
xlab = "Variety",
ylab = "Mean damage score for leaksynthesis")
boxplot(leak ~ regime,
data = potato,
xlab = "Regime",
ylab = "Mean damage score for leaksynthesis")
boxplot(leak ~ temp,
data = potato,
xlab = "Temp",
ylab = "Mean damage score for leaksynthesis")
```

It is obvious the mean of leak for species 1 (s1) and 2 (s2) are different, showing difference in mean leak by factor variety. This seems also hold true for factors regime and temperature. In the next stage we would like to investigate if the effect of each factor depends on the other factors; The profile plot of sample means (i.e., the interaction plot) (Fig.2) shows a clear interaction between variety and regime.

```{r echo=FALSE, fig.cap="Interaction plot of the mean damage score for leaksynthesis in potato plants, showing the effect of variety and regime on leak values.", fig.align="center"}
interaction.plot(regime,variety,leak,type='b',
col=1:2, pch=1:2,main="regime*variety")
```

the difference in the mean lengths for regime R and regime C depends on the varieties, with larger variety differences for regime R than for the regime C. This indicates in addition to main effects it is better include interaction effects in the model to analyze the data and inference if the main effects and interaction effects are statistically significant. 


## Full model

```{r echo = F}
myfit<-lm(leak~variety*regime*temp,
contrasts = c(variety=contr.sum, regime=contr.sum,temp=contr.sum))
```


The full model that we proceeded to fit is:


$$Leak_{ijkr} = \mu + \alpha_i + \beta_{ij} + \gamma_k + ( \alpha  \beta)_{ij} + (\alpha  \gamma)_{ik} + (\beta  \gamma)_{jk} + (\alpha  \beta  \gamma)_{ijk} + \epsilon_{ijkr}$$

Here, $\mu$ is the overall mean, $\alpha_i$ is the effect of level I of variety, $\beta_{ij}$ is the effect of level j of regime, and $\gamma_k$ is the effect of level k of temperature. $(\alpha \times \beta){ij}$ represents the two-way interaction effect between variety and regime, $(\alpha \times \gamma){ik}$ represents the two-way interaction effect between variety and temperature, $(\beta \times \gamma){jk}$ represents the two-way interaction effect between regime and temperature, and $(\alpha \times \beta \times \gamma){ijk}$ represents the three-way interaction effect between variety, regime, and temperature. $\epsilon_{ijkr}$ represents the error term that cannot be controlled. The indices $i=1,2$, $j=1,2$, $k=1,2$, and $r=1,2,\ldots,n_{ijk}$ denote the levels of the variety, regime, temperature, and the number of replicates, respectively.


### Model Assumptions

We checked the assumptions for our initial model. the normality assumption was not met as seen from the normal QQ plot (Fig3), and the Shapiro-Wilks Test ($p = 0.03256$). Also, from the plot of the residuals and the fitted values (Fig.4), and the Breusch Pagan Test ($p = 2.307\times10^{-6}$), there is evidence to conclude that the constant variance assumption was not met. We do not know enough about how the data was collected to make a definitive statement about independence, and do not see any reason to question the assumption as it pertains to this data.

## Results of the Analysis:

tell the reader what you found and how you found it. You may need to paste some outputs (not the raw output) from your code work to facilitate your explanation. For example, you may include a table of the results of F test in the And usually, you will include the residual plots in the appendix. Organize the section to tell the story you uncovered, not the circuitous path you may have taken to get there. Interpret your results. Report any strange features of the data.
Be sure that you address each of the studyâ€™s goals: if the experimenter wants to know which
treatment is best, you should attempt to answer that question and not just report the results of
an F test saying that the treatment means are different at the 5% level. You may also mention
strange qualities of the data and give suggestions for improving the data quality should future
studies be done. Figures and tables may be used to tell a large part of the story, if possible

```{r echo = F}
##fit full model
myfit<-lm(leak~variety*regime*temp,
contrasts = c(variety=contr.sum, regime=contr.sum,temp=contr.sum))

# Create a data frame with the results of the ANOVA Type III tests
anova_results <- data.frame(
  Term = c("(Intercept)", "variety", "regime", "temp", "variety:regime", "variety:temp", "regime:temp", "variety:regime:temp", "Residuals"),
  Sum_Sq = c(8110.7, 1919.2, 1517.7, 785.9, 2115.8, 44.0, 16.3, 83.5, 5053.1),
  Df = c(1, 1, 1, 1, 1, 1, 1, 1, 67),
  F_value = c(107.5408, 25.4465, 20.1233, 10.4207, 28.0529, 0.5829, 0.2158, 1.1069, NA),
  `Pr(>F)` = c(1.441e-15, 3.701e-06, 2.921e-05, 0.00193, 1.413e-06, 0.44787, 0.64373, 0.29654, NA)
)

# Convert the data frame into a markdown table
knitr::kable(anova_results, align = c("l", "r", "r", "r", "r"), digits = 4)


```





The table in the output provided shows the results of multiple F-tests for the full model, which test the significance of each individual predictor variable as well as their interactions.



## Conclusions: 
You should provide interpretation of the statistical results throughout the report and rehash the main results concisely in the Conclusion, using different wording than the summary. You may also include ideas you have about future studies. Most people tend to read the summary and conclusions first, then look at the figures and
tables. Then, if they have further interest, they read other sections of the report. Consequently, your summary and conclusion should be understandable by someone who has not read the rest of the paper, and all figures and tables should have complete captions







## Appendix:

Contains the technical details and plots not found in the Results section that
you want your readers to know. Also include your R code in the Appendix, so I can see what
you did in case you get a strange answer.


```{r fig3, fig.cap="Normal QQ plot of residuals"}

qqPlot(myfit$residuals, las = 1, main="QQ Plot")

```

